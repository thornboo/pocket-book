{% extends "ledger/base.html" %}
{% block header %}
    <!DOCTYPE html>
    <html lang="zh">
    <head>
        <meta charset="UTF-8">
        <title>index</title>
        <script src="../../static/bootstrap/jQuery/jquery-3.6.0.js" type="text/javascript"></script>
        <script type="text/javascript">
            mtr = document.getElementById("dt");

            //使用ajax加载csv文件的数据
            $.ajax({
                url: "http://localhost：8000/bill.csv", //应该写相对路径
                dataType: "csv",
                success: function (result) {
                    frag = document.createDocumentFragment();

                    // 对csv文件的数据先以行分割
                    datalist = result.split("\n");

                    // 我们再对每一行以逗号作分割
                    for (i = 0; i < datalist.length; i++) {
                        userary = datalist[i].split(",");
                        tr = document.createElement("tr");

                        // 对每行的内容遍历到td标签去
                        for (j = 0; j < userary.length; j++) {
                            td = document.createElement("td");
                            td.append(userary[j]);
                            tr.appendChild(td);
                        }
                        frag.appendChild(tr);
                    }
                    // 加载到web页面
                    mtr.appendChild(frag);
                }
            });
        </script>
    </head>
{% endblock header %}
{% block content %}
    <body>
    <div><br><br>
        <figure class="text-center">
            <blockquote class="blockquote">
                <p>别想一下造出大海，必须先由小河川开始。</p>
            </blockquote>
            <figcaption class="blockquote-footer">
                Z&Z<cite title="Source Title">记账</cite>
            </figcaption>
        </figure>
    </div>
    <span class="border border-4">2021年3月</span>
    <div class="datalist">
        <table class="table" id=dt>
            <tr>
                <td>类型</td>
                <td>时间</td>
                <td>分类</td>
                <td>金额</td>
            </tr>
        </table>
    </div>

    <div class="alert alert-primary" role="alert">
        本月总支出：
    </div>
    <div class="alert alert-success" role="alert">
        本月总收入：
    </div>
    <button type="button" class="btn btn-outline-success" onclick="window.location='{% url "ledger:record" %}'">记一笔
    </button>
    </body>
    </html>
{% endblock content %}